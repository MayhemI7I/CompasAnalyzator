<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compass Analyzer Desktop</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="material-icons logo-icon">explore</span>
                    <h1>Compass<br>Analyzer</h1>
                </div>
                <p class="version">v2.0 Desktop</p>
            </div>

            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-page="analyze">
                    <span class="material-icons">analytics</span>
                    <span>–ê–Ω–∞–ª–∏–∑</span>
                </a>
                <a href="#" class="nav-item" data-page="batch">
                    <span class="material-icons">folder_open</span>
                    <span>–ü–∞–∫–µ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑</span>
                </a>
                <a href="#" class="nav-item" data-page="history">
                    <span class="material-icons">history</span>
                    <span>–ò—Å—Ç–æ—Ä–∏—è</span>
                </a>
                <a href="#" class="nav-item" data-page="settings">
                    <span class="material-icons">settings</span>
                    <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </a>
            </nav>

            <div class="sidebar-footer">
                <div class="author-card">
                    <p class="author-name">–£–ª—å—è–Ω–æ–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä</p>
                    <p class="author-title">–†–µ–≥—É–ª–∏—Ä–æ–≤—â–∏–∫ 3-–≥–æ —Ä–∞–∑—Ä—è–¥–∞</p>
                    <p class="copyright">¬© 2025 Desktop Edition</p>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <div class="header-title">
                    <h2 id="page-title">–ê–Ω–∞–ª–∏–∑ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –∫–æ–º–ø–∞—Å–∞</h2>
                    <p id="page-subtitle">–ù–∞—Ç–∏–≤–Ω–æ–µ desktop –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="exportCSVBtn">
                        <span class="material-icons">table_chart</span>
                        CSV
                    </button>
                    <button class="btn btn-secondary" id="exportBtn">
                        <span class="material-icons">download</span>
                        JSON
                    </button>
                    <button class="btn btn-primary" id="analyzeBtn">
                        <span class="material-icons">play_arrow</span>
                        –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                    </button>
                </div>
            </header>

            <!-- Pages -->
            <div class="page active" id="analyzePage">
                <!-- Upload Zone -->
                <div class="upload-zone" id="uploadZone">
                    <span class="material-icons upload-icon">explore</span>
                    <h3>–ê–Ω–∞–ª–∏–∑ –∫–æ–º–ø–∞—Å–∞</h3>
                    <p>–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å –¥–∞–Ω–Ω—ã–º–∏:</p>
                    
                    <div style="width: 100%; max-width: 600px;">
                        <div class="form-group" style="margin: 0;">
                            <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <span class="material-icons" style="font-size: 20px;">keyboard</span>
                                <strong>–ü—É—Ç—å –∫ –ø–∞–ø–∫–µ –∫–æ–º–ø–∞—Å–∞:</strong>
                            </label>
                            <div class="input-group">
                                <input type="text" id="singleFolderInput" class="form-control" 
                                       placeholder="E:\MTCGeo\–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞\–ö–æ—Ä–∞–ª–ª\1234" 
                                       style="flex: 1;">
                                <button class="btn btn-primary" id="analyzeSingleBtn">
                                    <span class="material-icons">play_arrow</span>
                                    –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                                </button>
                            </div>
                        </div>
                        
                        <small style="color: var(--text-secondary); display: block; margin-top: 0.5rem;">
                            üí° –ü—Ä–∏–º–µ—Ä: E:\MTCGeo\–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞\–ö–æ—Ä–∞–ª–ª\–ù–æ–≤–∞—è –ø–∞–ø–∫–∞\17
                        </small>
                    </div>
                </div>

                <!-- Results Section - —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –≤ index.html -->
                <div class="results-section" id="resultsSection" style="display: none;">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <span class="material-icons stat-icon success">check_circle</span>
                            <div class="stat-content">
                                <h4 id="statValid">-</h4>
                                <p>–°—Ç–∞—Ç—É—Å</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <span class="material-icons stat-icon info">rotate_right</span>
                            <div class="stat-content">
                                <h4 id="statTurns">-</h4>
                                <p>–ù–∞–π–¥–µ–Ω–æ –ø–æ–≤–æ—Ä–æ—Ç–æ–≤</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <span class="material-icons stat-icon warning">lens_blur</span>
                            <div class="stat-content">
                                <h4 id="statSegments">-</h4>
                                <p>–°—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤</p>
                            </div>
                        </div>
                        <div class="stat-card">
                            <span class="material-icons stat-icon">dataset</span>
                            <div class="stat-content">
                                <h4 id="statAngles">-</h4>
                                <p>–í—Å–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏–π</p>
                            </div>
                        </div>
                    </div>

                    <div class="content-grid">
                        <div class="card chart-card">
                            <div class="card-header">
                                <h3>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —É–≥–ª–æ–≤</h3>
                            </div>
                            <div class="card-body">
                                <canvas id="polarChart"></canvas>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                <h3>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–≤–æ—Ä–æ—Ç–æ–≤</h3>
                                <span class="badge" id="turnsBadge">0</span>
                            </div>
                            <div class="card-body">
                                <div class="table-container">
                                    <table class="data-table">
                                        <thead>
                                            <tr>
                                                <th>#</th>
                                                <th>–ù–∞—á–∞–ª—å–Ω—ã–π —É–≥–æ–ª</th>
                                                <th>–ö–æ–Ω–µ—á–Ω—ã–π —É–≥–æ–ª</th>
                                                <th>–ò–∑–º–µ–Ω–µ–Ω–∏–µ</th>
                                                <th>–°—Ç–∞—Ç—É—Å</th>
                                            </tr>
                                        </thead>
                                        <tbody id="turnsTableBody">
                                            <tr>
                                                <td colspan="5" class="empty-state">
                                                    <span class="material-icons">info</span>
                                                    –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card log-card">
                        <div class="card-header">
                            <h3>–î–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥ –∞–Ω–∞–ª–∏–∑–∞</h3>
                            <button class="btn-icon" id="copyLogBtn">
                                <span class="material-icons">content_copy</span>
                            </button>
                        </div>
                        <div class="card-body">
                            <pre id="logViewer" class="log-viewer">–õ–æ–≥ –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞...</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Batch Page - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è -->
            <div class="page" id="batchPage">
                <div class="card">
                    <div class="card-header">
                        <h3>–ü–∞–∫–µ—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label>–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏</label>
                            <div class="input-group">
                                <input type="text" id="batchDirInput" class="form-control" 
                                       placeholder="E:\MTCGeo\–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞\–ö–æ—Ä–∞–ª–ª\–ù–æ–≤–∞—è –ø–∞–ø–∫–∞">
                                <button class="btn btn-primary" id="batchAnalyzeBtn">
                                    <span class="material-icons">play_arrow</span>
                                    –ó–∞–ø—É—Å—Ç–∏—Ç—å
                                </button>
                            </div>
                        </div>

                        <div class="batch-results" id="batchResults" style="display: none;">
                            <div class="batch-summary">
                                <div class="summary-item success">
                                    <span class="material-icons">check_circle</span>
                                    <span id="batchSuccess">0</span> —É—Å–ø–µ—à–Ω–æ
                                </div>
                                <div class="summary-item error">
                                    <span class="material-icons">cancel</span>
                                    <span id="batchFailed">0</span> —Å –æ—à–∏–±–∫–∞–º–∏
                                </div>
                                <div class="summary-item info">
                                    <span class="material-icons">analytics</span>
                                    <span id="batchTotal">0</span> –≤—Å–µ–≥–æ
                                </div>
                            </div>
                            
                            <div class="table-container" style="margin-top: 1.5rem;">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>–ö–æ–º–ø–∞—Å</th>
                                            <th>–°—Ç–∞—Ç—É—Å</th>
                                            <th>–ü–æ–≤–æ—Ä–æ—Ç—ã</th>
                                            <th>–ò–∑–º–µ—Ä–µ–Ω–∏–π</th>
                                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                        </tr>
                                    </thead>
                                    <tbody id="batchResultsBody"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- History Page -->
            <div class="page" id="historyPage"></div>

            <!-- Settings Page - —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –≤ index.html -->
            <div class="page" id="settingsPage">
                <div class="card">
                    <div class="card-header">
                        <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∞–ª–∏–∑–∞</h3>
                    </div>
                    <div class="card-body">
                        <div class="settings-info-box">
                            <span class="material-icons">info</span>
                            <div>
                                <strong>–í–∞–∂–Ω–æ:</strong> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –Ω–æ–≤—ã–º –∞–Ω–∞–ª–∏–∑–∞–º.
                            </div>
                        </div>

                        <div class="form-group">
                            <label>–ü–æ—Ä–æ–≥ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ (–≥—Ä–∞–¥—É—Å—ã)</label>
                            <input type="number" id="setting-stability" class="form-control" 
                                   value="5.0" step="0.1" min="0" max="20">
                            <small>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 3.0 - 7.0</small>
                        </div>

                        <div class="form-group">
                            <label>–î–æ–ø—É—Å–∫ –ø–æ–≤–æ—Ä–æ—Ç–∞ (–≥—Ä–∞–¥—É—Å—ã)</label>
                            <input type="number" id="setting-tolerance" class="form-control" 
                                   value="10.0" step="0.1" min="0" max="30">
                            <small>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 8.0 - 12.0. –°—Ç–∞–Ω–¥–∞—Ä—Ç: 10.0¬∞</small>
                        </div>

                        <div class="form-group">
                            <label>–î–æ–ø—É—Å–∫ —Å—É–º–º—ã –ø–æ–≤–æ—Ä–æ—Ç–æ–≤ (–≥—Ä–∞–¥—É—Å—ã)</label>
                            <input type="number" id="setting-sumTolerance" class="form-control" 
                                   value="20.0" step="0.1" min="0" max="50">
                            <small>–°—É–º–º–∞ 4-—Ö –ø–æ–≤–æ—Ä–æ—Ç–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å ‚âà360¬∞. –°—Ç–∞–Ω–¥–∞—Ä—Ç: 20.0¬∞</small>
                        </div>

                        <div class="form-group">
                            <label>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å–µ–≥–º–µ–Ω—Ç–∞</label>
                            <input type="number" id="setting-minLength" class="form-control" 
                                   value="2" step="1" min="1" max="10">
                            <small>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 2 - 3</small>
                        </div>

                        <div class="form-group">
                            <label>–ú–∞–∫—Å–∏–º—É–º –≤—ã–±—Ä–æ—Å–æ–≤ (–≥–∏—Å—Ç–µ—Ä–µ–∑–∏—Å)</label>
                            <input type="number" id="setting-outliers" class="form-control" 
                                   value="0" step="1" min="0" max="10">
                            <small>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: 0 - 3</small>
                        </div>

                        <div class="settings-actions">
                            <button class="btn btn-primary" id="saveSettingsBtn">
                                <span class="material-icons">save</span>
                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                            <button class="btn btn-secondary" id="resetSettingsBtn">
                                <span class="material-icons">restore</span>
                                –°–±—Ä–æ—Å–∏—Ç—å
                            </button>
                        </div>

                        <div class="settings-preview">
                            <h4>–¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è</h4>
                            <div class="settings-preview-grid">
                                <div class="preview-item">
                                    <span class="preview-label">–ü–æ—Ä–æ–≥ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏:</span>
                                    <span class="preview-value" id="preview-stability">5.0¬∞</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">–î–æ–ø—É—Å–∫ –ø–æ–≤–æ—Ä–æ—Ç–∞:</span>
                                    <span class="preview-value" id="preview-tolerance">¬±10.0¬∞</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">–î–æ–ø—É—Å–∫ —Å—É–º–º—ã:</span>
                                    <span class="preview-value" id="preview-sumTolerance">¬±20.0¬∞</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">–ú–∏–Ω. –¥–ª–∏–Ω–∞:</span>
                                    <span class="preview-value" id="preview-minLength">2</span>
                                </div>
                                <div class="preview-item">
                                    <span class="preview-label">–ú–∞–∫—Å. –≤—ã–±—Ä–æ—Å–æ–≤:</span>
                                    <span class="preview-value" id="preview-outliers">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p class="loading-text">–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...</p>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="wailsjs/runtime/runtime.js"></script>
    <script src="app_desktop.js"></script>
</body>
</html>

